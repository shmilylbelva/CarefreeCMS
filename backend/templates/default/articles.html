{extend name="default/layout" /}

{block name="title"}文章列表 - {$site.site_name|default='国产CMS'}{/block}

{block name="content"}
<div class="page-header">
    <h1>全部文章</h1>
    <div class="breadcrumb">
        <a href="{$base_url}/index.html">首页</a>
        <span class="separator">/</span>
        <span>文章列表</span>
    </div>
</div>

<!-- 筛选和排序 -->
<div class="filter-bar">
    <div class="filter-left">
        <span class="total-count">共 {$total} 篇文章</span>
    </div>
    <div class="filter-right">
        <select class="sort-select" onchange="location.href=this.value">
            <option value="?order=latest" {if condition="isset($order) && $order == 'latest'"}selected{/if}>最新发布</option>
            <option value="?order=hot" {if condition="isset($order) && $order == 'hot'"}selected{/if}>最热文章</option>
            <option value="?order=views" {if condition="isset($order) && $order == 'views'"}selected{/if}>浏览最多</option>
        </select>
    </div>
</div>

<!-- 文章列表 -->
<div class="articles-container">
    {if condition="$articles"}
    <div class="article-list">
        {carefree:foreach from="$articles" item="article"}
        <article class="article-item-large">
            {if condition="!empty($article['cover_image'])"}
            <div class="article-thumbnail">
                <a href="{$base_url}/article/{$article.id}.html">
                    <img src="{$article.cover_image}" alt="{$article.title}" loading="lazy">
                </a>
                {if condition="!empty($article['flag'])"}
                <span class="article-flag {$article.flag|lower}">{$article.flag}</span>
                {/if}
            </div>
            {/if}

            <div class="article-content">
                <h2 class="article-title">
                    <a href="{$base_url}/article/{$article.id}.html">{$article.title}</a>
                </h2>

                {if condition="!empty($article['summary'])"}
                <p class="article-excerpt">{$article.summary}</p>
                {/if}

                <div class="article-meta">
                    {if condition="isset($article['category_id'])"}
                    <span class="category">
                        <i class="icon-folder"></i>
                        <a href="{$base_url}/category/{$article.category_id}.html">{$article.category_name|default='未分类'}</a>
                    </span>
                    {/if}
                    <span class="author">
                        <i class="icon-user"></i>
                        {$article.author}
                    </span>
                    <span class="date">
                        <i class="icon-calendar"></i>
                        {$article.publish_time|date='Y-m-d H:i'}
                    </span>
                    <span class="views">
                        <i class="icon-eye"></i>
                        {$article.views} 阅读
                    </span>
                    {if condition="$article['comment_count'] > 0"}
                    <span class="comments">
                        <i class="icon-comment"></i>
                        {$article.comment_count} 评论
                    </span>
                    {/if}
                </div>

                {if condition="!empty($article['tags'])"}
                <div class="article-tags">
                    {carefree:foreach from="$article.tags" item="tag"}
                    <a href="{$base_url}/tag/{$tag.id}.html" class="tag">{$tag.name}</a>
                    {/carefree:foreach}
                </div>
                {/if}
            </div>
        </article>
        {/carefree:foreach}
    </div>

    <!-- 分页 -->
    {if condition="$pages > 1"}
    <div class="pagination">
        {if condition="$page > 1"}
        <a href="?page={$page - 1}" class="page-link prev">上一页</a>
        {/if}

        {for start="1" end="$pages" name="p"}
        {if condition="$p == $page"}
        <span class="page-link active">{$p}</span>
        {else /}
        <a href="?page={$p}" class="page-link">{$p}</a>
        {/if}
        {/for}

        {if condition="$page < $pages"}
        <a href="?page={$page + 1}" class="page-link next">下一页</a>
        {/if}
    </div>
    {/if}

    {else /}
    <div class="empty-state">
        <p>暂无文章</p>
    </div>
    {/if}
</div>
{/block}
