# è¯„è®ºç³»ç»Ÿä¼˜åŒ–åŠŸèƒ½ä½¿ç”¨æŒ‡å—

> CarefreeCMS è¯„è®ºç³»ç»Ÿä¼˜åŒ–å®Œæ•´æ–‡æ¡£ - æ•æ„Ÿè¯è¿‡æ»¤ã€ç”¨æˆ·é€šçŸ¥ã€æ™ºèƒ½å®¡æ ¸

**ç‰ˆæœ¬**: v1.7.0
**æœ€åæ›´æ–°**: 2025-11-08

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

è¯„è®ºç³»ç»Ÿä¼˜åŒ–åŒ…å«ä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **æ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿ** - åŸºäºDFAç®—æ³•çš„é«˜æ•ˆæ•æ„Ÿè¯æ£€æµ‹ï¼Œæ”¯æŒæ–‡ç« ã€è¯„è®ºã€å•é¡µç­‰æ‰€æœ‰å†…å®¹
2. **ç”¨æˆ·é€šçŸ¥ç³»ç»Ÿ** - ç«™å†…ä¿¡+é‚®ä»¶åŒæ¸ é“é€šçŸ¥ï¼Œæ”¯æŒè¯„è®ºå›å¤ã€ç‚¹èµã€æ–‡ç« å®¡æ ¸ç­‰åœºæ™¯
3. **æ™ºèƒ½å®¡æ ¸ç³»ç»Ÿ** - åŸºäºç”¨æˆ·ä¿¡èª‰åº¦çš„æ™ºèƒ½å®¡æ ¸æœºåˆ¶ï¼Œè‡ªåŠ¨è¯†åˆ«å’Œå¤„ç†è¿è§„å†…å®¹

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### æ•æ„Ÿè¯è¿‡æ»¤
- âœ… **DFAç®—æ³•** - å­—å…¸æ ‘å®ç°ï¼Œæ£€æµ‹æ•ˆç‡O(n)
- âœ… **ä¸‰çº§å¤„ç†** - æç¤ºè­¦å‘Šã€è‡ªåŠ¨æ›¿æ¢ã€æ‹’ç»å‘å¸ƒ
- âœ… **åˆ†ç±»ç®¡ç†** - æ”¿æ²»ã€è‰²æƒ…ã€æš´åŠ›ã€å¹¿å‘Šã€è¾±éª‚ç­‰6å¤§ç±»
- âœ… **æ‰¹é‡å¯¼å…¥** - æ”¯æŒæ‰¹é‡å¯¼å…¥æ•æ„Ÿè¯åº“
- âœ… **å…¨å±€åº”ç”¨** - é€‚ç”¨äºæ–‡ç« ã€è¯„è®ºã€å•é¡µç­‰æ‰€æœ‰æ–‡æœ¬å†…å®¹
- âœ… **å®æ—¶ç¼“å­˜** - Redisç¼“å­˜æ•æ„Ÿè¯æ ‘ï¼Œ1å°æ—¶TTL
- âœ… **å‘½ä¸­ç»Ÿè®¡** - è®°å½•æ¯ä¸ªæ•æ„Ÿè¯çš„å‘½ä¸­æ¬¡æ•°

### ç”¨æˆ·é€šçŸ¥
- âœ… **ç«™å†…ä¿¡é€šçŸ¥** - å®æ—¶ç«™å†…æ¶ˆæ¯æ¨é€
- âœ… **é‚®ä»¶é€šçŸ¥** - å¼‚æ­¥é‚®ä»¶é˜Ÿåˆ—å‘é€
- âœ… **é€šçŸ¥ç±»å‹** - è¯„è®ºå›å¤ã€ç‚¹èµã€æ–‡ç« å®¡æ ¸ã€ç³»ç»Ÿé€šçŸ¥
- âœ… **ä¸ªæ€§åŒ–è®¾ç½®** - ç”¨æˆ·å¯è‡ªå®šä¹‰æ¥æ”¶æ¸ é“
- âœ… **æœªè¯»æ•°ç»Ÿè®¡** - å®æ—¶æœªè¯»æ¶ˆæ¯è®¡æ•°
- âœ… **æ‰¹é‡æ“ä½œ** - æ‰¹é‡æ ‡è®°å·²è¯»ã€æ‰¹é‡åˆ é™¤

### æ™ºèƒ½å®¡æ ¸
- âœ… **ä¿¡èª‰åº¦ç³»ç»Ÿ** - 100åˆ†åˆ¶ç”¨æˆ·ä¿¡èª‰è¯„åˆ†
- âœ… **è‡ªåŠ¨å®¡æ ¸** - é«˜ä¿¡èª‰ç”¨æˆ·è‡ªåŠ¨é€šè¿‡å®¡æ ¸
- âœ… **è¿è§„è®°å½•** - å®Œæ•´çš„è¿è§„å†…å®¹è¿½è¸ª
- âœ… **åˆ†çº§å¤„ç†** - æ ¹æ®è¿è§„ç¨‹åº¦è‡ªåŠ¨é™ä½ä¿¡èª‰åº¦

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### 1. æ•æ„Ÿè¯åº“è¡¨ (sensitive_words)

```sql
CREATE TABLE `sensitive_words` (
  `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `word` varchar(100) NOT NULL COMMENT 'æ•æ„Ÿè¯',
  `level` tinyint(1) NOT NULL DEFAULT '2' COMMENT 'å¤„ç†çº§åˆ«(1-æç¤º 2-æ›¿æ¢ 3-æ‹’ç»)',
  `replacement` varchar(10) DEFAULT '***' COMMENT 'æ›¿æ¢è¯',
  `category` varchar(50) DEFAULT 'general' COMMENT 'åˆ†ç±»',
  `is_enabled` tinyint(1) NOT NULL DEFAULT '1' COMMENT 'å¯ç”¨çŠ¶æ€',
  `hit_count` int(11) DEFAULT '0' COMMENT 'å‘½ä¸­æ¬¡æ•°',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨è¯´æ˜',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_word` (`word`),
  KEY `idx_category` (`category`),
  KEY `idx_enabled` (`is_enabled`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**åˆ†ç±»è¯´æ˜**:
- `politics` - æ”¿æ²»æ•æ„Ÿ
- `porn` - è‰²æƒ…å†…å®¹
- `violence` - æš´åŠ›å†…å®¹
- `ad` - å¹¿å‘Šå†…å®¹
- `abuse` - è¾±éª‚å†…å®¹
- `general` - å…¶ä»–

**å¤„ç†çº§åˆ«**:
- `1` - æç¤ºè­¦å‘Šï¼ˆå…è®¸å‘å¸ƒï¼Œä½†è®°å½•è¿è§„ï¼‰
- `2` - è‡ªåŠ¨æ›¿æ¢ï¼ˆæ›¿æ¢ä¸º***åå‘å¸ƒï¼‰
- `3` - æ‹’ç»å‘å¸ƒï¼ˆç›´æ¥æ‹’ç»ï¼Œä¸å…è®¸å‘å¸ƒï¼‰

### 2. è¿è§„å†…å®¹è®°å½•è¡¨ (content_violations)

```sql
CREATE TABLE `content_violations` (
  `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `content_type` varchar(20) NOT NULL COMMENT 'å†…å®¹ç±»å‹(article/comment/page)',
  `content_id` int(11) UNSIGNED NOT NULL,
  `user_id` int(11) UNSIGNED NOT NULL,
  `matched_words` text COMMENT 'åŒ¹é…åˆ°çš„æ•æ„Ÿè¯(JSON)',
  `original_content` text COMMENT 'åŸå§‹å†…å®¹ç‰‡æ®µ',
  `filtered_content` text COMMENT 'è¿‡æ»¤åå†…å®¹',
  `action` varchar(20) NOT NULL COMMENT 'å¤„ç†åŠ¨ä½œ(warn/replace/reject)',
  `status` varchar(20) NOT NULL DEFAULT 'pending' COMMENT 'çŠ¶æ€',
  `reviewed_by` int(11) UNSIGNED DEFAULT NULL,
  `reviewed_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_content` (`content_type`, `content_id`),
  KEY `idx_user` (`user_id`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 3. ç”¨æˆ·é€šçŸ¥è¡¨ (user_notifications)

```sql
CREATE TABLE `user_notifications` (
  `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `user_id` int(11) UNSIGNED NOT NULL COMMENT 'æ¥æ”¶ç”¨æˆ·ID',
  `type` varchar(50) NOT NULL COMMENT 'é€šçŸ¥ç±»å‹',
  `title` varchar(200) NOT NULL,
  `content` text,
  `related_type` varchar(20) DEFAULT NULL,
  `related_id` int(11) UNSIGNED DEFAULT NULL,
  `sender_id` int(11) UNSIGNED DEFAULT NULL,
  `is_read` tinyint(1) NOT NULL DEFAULT '0',
  `read_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_user` (`user_id`, `is_read`),
  KEY `idx_type` (`type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**é€šçŸ¥ç±»å‹**:
- `comment_reply` - è¯„è®ºå›å¤
- `comment_like` - è¯„è®ºç‚¹èµ
- `article_approved` - æ–‡ç« å®¡æ ¸é€šè¿‡
- `article_rejected` - æ–‡ç« è¢«æ‹’ç»
- `system` - ç³»ç»Ÿé€šçŸ¥

### 4. ç”¨æˆ·é€šçŸ¥è®¾ç½®è¡¨ (user_notification_settings)

### 5. ç”¨æˆ·ä¿¡èª‰åº¦è¡¨ (user_reputation)

---

## ğŸ’» åç«¯APIä½¿ç”¨

### 1. æ•æ„Ÿè¯ç®¡ç†API

#### 1.1 è·å–æ•æ„Ÿè¯åˆ—è¡¨
```http
GET /api/sensitive-words?page=1&page_size=20&category=politics
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "total": 100,
    "list": [
      {
        "id": 1,
        "word": "ååŠ¨",
        "level": 3,
        "category": "politics",
        "hit_count": 5
      }
    ]
  }
}
```

#### 1.2 åˆ›å»ºæ•æ„Ÿè¯
```http
POST /api/sensitive-words
Content-Type: application/json

{
  "word": "æµ‹è¯•æ•æ„Ÿè¯",
  "level": 2,
  "category": "general",
  "replacement": "***",
  "is_enabled": 1
}
```

#### 1.3 æ‰¹é‡å¯¼å…¥
```http
POST /api/sensitive-words/batch-import
Content-Type: application/json

{
  "words": "æ•æ„Ÿè¯1\næ•æ„Ÿè¯2\næ•æ„Ÿè¯3",
  "level": 2,
  "category": "general",
  "replacement": "***"
}
```

#### 1.4 æµ‹è¯•æ£€æµ‹
```http
POST /api/sensitive-words/test-check
Content-Type: application/json

{
  "content": "è¿™æ˜¯ä¸€æ®µåŒ…å«æ•æ„Ÿè¯çš„æµ‹è¯•æ–‡æœ¬"
}
```

**å“åº”**:
```json
{
  "code": 0,
  "data": {
    "has_sensitive": true,
    "matched_words": ["æ•æ„Ÿè¯"],
    "matched_count": 1,
    "filtered_content": "è¿™æ˜¯ä¸€æ®µåŒ…å«***çš„æµ‹è¯•æ–‡æœ¬",
    "matched_details": [
      {
        "word": "æ•æ„Ÿè¯",
        "level": 2,
        "category": "general",
        "replacement": "***"
      }
    ]
  }
}
```

### 2. é›†æˆåˆ°æ–‡ç« /è¯„è®ºå‘å¸ƒ

#### 2.1 åœ¨æ–‡ç« æ§åˆ¶å™¨ä¸­é›†æˆ

```php
use app\service\SensitiveWordService;

public function save(Request $request): Response
{
    $data = $request->only(['title', 'content', ...]);
    $userId = $request->userId ?? 0;

    // æ•æ„Ÿè¯æ£€æµ‹
    $sensitiveService = new SensitiveWordService();

    // æ£€æµ‹æ ‡é¢˜
    $titleResult = $sensitiveService->checkAndHandle(
        'article',
        0, // æ–°æ–‡ç« IDä¸º0
        $userId,
        $data['title'],
        true // è‡ªåŠ¨æ›¿æ¢
    );

    if (!$titleResult['allowed']) {
        return json([
            'code' => 400,
            'message' => $titleResult['message'],
            'data' => ['matched_words' => $titleResult['matched_words']]
        ]);
    }

    // æ£€æµ‹å†…å®¹
    $contentResult = $sensitiveService->checkAndHandle(
        'article',
        0,
        $userId,
        $data['content'],
        true
    );

    if (!$contentResult['allowed']) {
        return json([
            'code' => 400,
            'message' => $contentResult['message']
        ]);
    }

    // ä½¿ç”¨è¿‡æ»¤åçš„å†…å®¹
    $data['title'] = $titleResult['content'];
    $data['content'] = $contentResult['content'];

    // ä¿å­˜æ–‡ç« ...
    $article = Article::create($data);

    return json(['code' => 0, 'message' => 'å‘å¸ƒæˆåŠŸ']);
}
```

#### 2.2 åœ¨è¯„è®ºæ§åˆ¶å™¨ä¸­é›†æˆ

```php
public function save(Request $request): Response
{
    $data = $request->only(['article_id', 'content', 'parent_id']);
    $userId = $request->userId ?? 0;

    // æ•æ„Ÿè¯æ£€æµ‹
    $sensitiveService = new SensitiveWordService();
    $result = $sensitiveService->checkAndHandle(
        'comment',
        0,
        $userId,
        $data['content'],
        true // è‡ªåŠ¨æ›¿æ¢
    );

    if (!$result['allowed']) {
        return json([
            'code' => 400,
            'message' => $result['message']
        ]);
    }

    $data['content'] = $result['content'];

    // ä¿å­˜è¯„è®º
    $comment = Comment::create($data);

    // å‘é€é€šçŸ¥ï¼ˆå¦‚æœæ˜¯å›å¤ï¼‰
    if ($data['parent_id']) {
        $parentComment = Comment::find($data['parent_id']);
        if ($parentComment && $parentComment->user_id != $userId) {
            $notificationService = new NotificationService();
            $notificationService->sendCommentReplyNotification(
                $comment->id,
                $parentComment->user_id,
                $userId,
                $data['article_id'],
                $article->title,
                $data['content']
            );
        }
    }

    return json(['code' => 0, 'message' => 'è¯„è®ºæˆåŠŸ']);
}
```

### 3. ç”¨æˆ·é€šçŸ¥API

#### 3.1 è·å–é€šçŸ¥åˆ—è¡¨
```http
GET /api/user-notifications?page=1&page_size=20&is_read=0
Authorization: Bearer {token}
```

#### 3.2 è·å–æœªè¯»æ•°é‡
```http
GET /api/user-notifications/unread-count
Authorization: Bearer {token}
```

#### 3.3 æ ‡è®°ä¸ºå·²è¯»
```http
POST /api/user-notifications/{id}/mark-as-read
Authorization: Bearer {token}
```

#### 3.4 å…¨éƒ¨æ ‡è®°ä¸ºå·²è¯»
```http
POST /api/user-notifications/mark-all-as-read
Authorization: Bearer {token}
```

#### 3.5 è·å–/æ›´æ–°é€šçŸ¥è®¾ç½®
```http
GET /api/user-notifications/settings
POST /api/user-notifications/settings

{
  "settings": {
    "comment_reply": {
      "site_enabled": 1,
      "email_enabled": 1
    },
    "comment_like": {
      "site_enabled": 1,
      "email_enabled": 0
    }
  }
}
```

---

## ğŸ¨ å‰ç«¯é›†æˆ

### 1. æ•æ„Ÿè¯ç®¡ç†ç•Œé¢

åˆ›å»º `frontend/src/views/system/SensitiveWords.vue`:

```vue
<template>
  <div class="sensitive-words-container">
    <el-card>
      <template #header>
        <div class="card-header">
          <span>æ•æ„Ÿè¯ç®¡ç†</span>
          <div>
            <el-button type="primary" @click="handleAdd">æ·»åŠ æ•æ„Ÿè¯</el-button>
            <el-button @click="handleBatchImport">æ‰¹é‡å¯¼å…¥</el-button>
            <el-button type="success" @click="handleTest">æµ‹è¯•æ£€æµ‹</el-button>
          </div>
        </div>
      </template>

      <!-- ç­›é€‰æ¡ä»¶ -->
      <el-form :inline="true" :model="searchForm">
        <el-form-item label="åˆ†ç±»">
          <el-select v-model="searchForm.category" clearable>
            <el-option label="å…¨éƒ¨" value="" />
            <el-option v-for="(label, value) in categories" :key="value"
              :label="label" :value="value" />
          </el-select>
        </el-form-item>
        <el-form-item label="çº§åˆ«">
          <el-select v-model="searchForm.level" clearable>
            <el-option label="å…¨éƒ¨" value="" />
            <el-option v-for="(label, value) in levels" :key="value"
              :label="label" :value="value" />
          </el-select>
        </el-form-item>
        <el-form-item label="å…³é”®è¯">
          <el-input v-model="searchForm.keyword" placeholder="æœç´¢æ•æ„Ÿè¯" />
        </el-form-item>
        <el-form-item>
          <el-button type="primary" @click="loadList">æŸ¥è¯¢</el-button>
          <el-button @click="handleReset">é‡ç½®</el-button>
        </el-form-item>
      </el-form>

      <!-- æ•°æ®è¡¨æ ¼ -->
      <el-table :data="list" v-loading="loading">
        <el-table-column type="selection" width="55" />
        <el-table-column prop="word" label="æ•æ„Ÿè¯" />
        <el-table-column prop="category" label="åˆ†ç±»">
          <template #default="{row}">
            <el-tag>{{ categories[row.category] }}</el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="level" label="å¤„ç†çº§åˆ«">
          <template #default="{row}">
            <el-tag :type="getLevelType(row.level)">
              {{ levels[row.level] }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="hit_count" label="å‘½ä¸­æ¬¡æ•°" width="100" />
        <el-table-column prop="is_enabled" label="çŠ¶æ€" width="80">
          <template #default="{row}">
            <el-switch v-model="row.is_enabled" :active-value="1" :inactive-value="0"
              @change="handleStatusChange(row)" />
          </template>
        </el-table-column>
        <el-table-column label="æ“ä½œ" width="180" fixed="right">
          <template #default="{row}">
            <el-button type="primary" link @click="handleEdit(row)">ç¼–è¾‘</el-button>
            <el-button type="danger" link @click="handleDelete(row.id)">åˆ é™¤</el-button>
          </template>
        </el-table-column>
      </el-table>

      <!-- åˆ†é¡µ -->
      <el-pagination
        v-model:current-page="page"
        v-model:page-size="pageSize"
        :total="total"
        @current-change="loadList"
        layout="total, prev, pager, next, jumper"
      />
    </el-card>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue'
import { ElMessage } from 'element-plus'
import {
  getSensitiveWords,
  createSensitiveWord,
  updateSensitiveWord,
  deleteSensitiveWord,
  getSensitiveWordCategories,
  getSensitiveWordLevels
} from '@/api/sensitiveWord'

const loading = ref(false)
const list = ref([])
const total = ref(0)
const page = ref(1)
const pageSize = ref(20)
const categories = ref({})
const levels = ref({})

const searchForm = reactive({
  category: '',
  level: '',
  keyword: ''
})

const loadList = async () => {
  loading.value = true
  try {
    const res = await getSensitiveWords({
      page: page.value,
      page_size: pageSize.value,
      ...searchForm
    })
    list.value = res.data.list
    total.value = res.data.total
  } finally {
    loading.value = false
  }
}

const loadOptions = async () => {
  const [catRes, levelRes] = await Promise.all([
    getSensitiveWordCategories(),
    getSensitiveWordLevels()
  ])
  categories.value = catRes.data
  levels.value = levelRes.data
}

const getLevelType = (level) => {
  const types = { 1: 'info', 2: 'warning', 3: 'danger' }
  return types[level] || ''
}

onMounted(() => {
  loadOptions()
  loadList()
})
</script>
```

### 2. APIå°è£…

åˆ›å»º `frontend/src/api/sensitiveWord.js`:

```javascript
import request from '@/utils/request'

export function getSensitiveWords(params) {
  return request({
    url: '/sensitive-words',
    method: 'get',
    params
  })
}

export function createSensitiveWord(data) {
  return request({
    url: '/sensitive-words',
    method: 'post',
    data
  })
}

export function updateSensitiveWord(id, data) {
  return request({
    url: `/sensitive-words/${id}`,
    method: 'put',
    data
  })
}

export function deleteSensitiveWord(id) {
  return request({
    url: `/sensitive-words/${id}`,
    method: 'delete'
  })
}

export function batchImportSensitiveWords(data) {
  return request({
    url: '/sensitive-words/batch-import',
    method: 'post',
    data
  })
}

export function testSensitiveWord(data) {
  return request({
    url: '/sensitive-words/test-check',
    method: 'post',
    data
  })
}

export function getSensitiveWordCategories() {
  return request({
    url: '/sensitive-words/categories',
    method: 'get'
  })
}

export function getSensitiveWordLevels() {
  return request({
    url: '/sensitive-words/levels',
    method: 'get'
  })
}
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### 1. æ·»åŠ è·¯ç”±é…ç½®

åœ¨ `backend/route/api.php` ä¸­æ·»åŠ ï¼š

```php
// æ•æ„Ÿè¯ç®¡ç†ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
Route::resource('sensitive-words', 'app\controller\api\SensitiveWordController');
Route::post('sensitive-words/batch-import', 'app\controller\api\SensitiveWordController@batchImport');
Route::post('sensitive-words/batch-delete', 'app\controller\api\SensitiveWordController@batchDelete');
Route::post('sensitive-words/batch-update-status', 'app\controller\api\SensitiveWordController@batchUpdateStatus');
Route::get('sensitive-words/categories', 'app\controller\api\SensitiveWordController@categories');
Route::get('sensitive-words/levels', 'app\controller\api\SensitiveWordController@levels');
Route::get('sensitive-words/statistics', 'app\controller\api\SensitiveWordController@statistics');
Route::post('sensitive-words/test-check', 'app\controller\api\SensitiveWordController@testCheck');

// è¿è§„è®°å½•ç®¡ç†
Route::resource('content-violations', 'app\controller\api\ContentViolationController')->except(['save', 'update']);
Route::post('content-violations/{id}/mark-reviewed', 'app\controller\api\ContentViolationController@markAsReviewed');
Route::post('content-violations/{id}/mark-ignored', 'app\controller\api\ContentViolationController@markAsIgnored');
Route::post('content-violations/batch-review', 'app\controller\api\ContentViolationController@batchReview');

// ç”¨æˆ·é€šçŸ¥ï¼ˆå‰å°ï¼‰
Route::get('user-notifications', 'app\controller\api\UserNotificationController@index');
Route::get('user-notifications/unread-count', 'app\controller\api\UserNotificationController@unreadCount');
Route::post('user-notifications/{id}/mark-as-read', 'app\controller\api\UserNotificationController@markAsRead');
Route::post('user-notifications/batch-mark-as-read', 'app\controller\api\UserNotificationController@batchMarkAsRead');
Route::post('user-notifications/mark-all-as-read', 'app\controller\api\UserNotificationController@markAllAsRead');
Route::delete('user-notifications/{id}', 'app\controller\api\UserNotificationController@delete');
Route::delete('user-notifications/clear-read', 'app\controller\api\UserNotificationController@clearRead');
Route::get('user-notifications/settings', 'app\controller\api\UserNotificationController@settings');
Route::post('user-notifications/settings', 'app\controller\api\UserNotificationController@updateSettings');
```

### 2. å‰ç«¯è·¯ç”±é…ç½®

åœ¨ `frontend/src/router/index.js` ä¸­æ·»åŠ ï¼š

```javascript
{
  path: 'sensitive-words',
  name: 'SensitiveWords',
  component: () => import('@/views/system/SensitiveWords.vue'),
  meta: { title: 'æ•æ„Ÿè¯ç®¡ç†' }
},
{
  path: 'content-violations',
  name: 'ContentViolations',
  component: () => import('@/views/system/ContentViolations.vue'),
  meta: { title: 'è¿è§„è®°å½•' }
}
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ•æ„Ÿè¯æ£€æµ‹æ€§èƒ½

- **DFAç®—æ³•**: æ—¶é—´å¤æ‚åº¦O(n)ï¼Œnä¸ºæ–‡æœ¬é•¿åº¦
- **Redisç¼“å­˜**: æ•æ„Ÿè¯æ ‘ç¼“å­˜1å°æ—¶ï¼Œé¿å…é¢‘ç¹è¯»å–æ•°æ®åº“
- **æ‰¹é‡æ£€æµ‹**: æ”¯æŒä¸€æ¬¡æ£€æµ‹å¤šä¸ªå­—æ®µ

### 2. ç¼“å­˜ç­–ç•¥

```php
// æ¸…é™¤æ•æ„Ÿè¯ç¼“å­˜ï¼ˆæ·»åŠ /æ›´æ–°/åˆ é™¤æ•æ„Ÿè¯åè‡ªåŠ¨è°ƒç”¨ï¼‰
SensitiveWordService::clearCache();

// æ‰‹åŠ¨é‡æ–°åŠ è½½
$service = new SensitiveWordService();
$service->reload();
```

---

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

1. **æ•æ„Ÿè¯åº“ä¿æŠ¤**: æ•æ„Ÿè¯ç®¡ç†æ¥å£éœ€è¦ç®¡ç†å‘˜æƒé™
2. **å†…å®¹è®°å½•**: æ‰€æœ‰è¿è§„å†…å®¹éƒ½æœ‰å®Œæ•´è®°å½•ï¼Œä¾¿äºå®¡æ ¸å’Œè¿½æº¯
3. **ç”¨æˆ·ä¿¡èª‰**: é€šè¿‡ä¿¡èª‰åº¦ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«æ¶æ„ç”¨æˆ·
4. **é¢‘ç‡é™åˆ¶**: å»ºè®®å¯¹è¯„è®ºå‘å¸ƒæ·»åŠ é¢‘ç‡é™åˆ¶ï¼ˆå¦‚1åˆ†é’Ÿå†…æœ€å¤š3æ¡ï¼‰

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£**: [docs/COMMENT_SYSTEM_OPTIMIZATION_GUIDE.md](./COMMENT_SYSTEM_OPTIMIZATION_GUIDE.md)
- **é—®é¢˜åé¦ˆ**: https://gitee.com/carefreeteam/issues
- **é‚®ç®±**: sinma@qq.com
- **QQç¾¤**: 113572201

---

**Made with â¤ï¸ by CarefreeCMS Team Â© 2025**
